# CodeRec - Diverse Code Recommendation System

CodeRec is a tool for generating and analyzing diverse code recommendations using both LSTM and ChatGPT models. The system aims to provide varied recommendations to assist with prompt engineering and code suggestion diversity.

## Overview

This project implements a system that:
1. Generates candidate code or text suggestions using either a custom LSTM model or OpenAI's ChatGPT
2. Analyzes the diversity of suggestions using embedding-based similarity measures
3. Uses a genetic algorithm to select the most diverse subset of suggestions
4. Provides a web interface for interacting with the system

The core goal is to maximize the diversity of recommendations while maintaining relevance to the original prompt.

## Project Structure

- **cluster_analysis/**: Contains genetic algorithm implementation for selecting diverse candidates
- **data/**: Data processing utilities and database handling
- **flask_app/**: Web application for interacting with the system
- **neural/**: Neural network architectures and training routines
  - **architectures/**: LSTM and MLP model definitions
  - **embeddings/**: Embedding extraction and sampling utilities
  - **train/**: Training loops and loss visualization
- **utils/**: Utility functions for similarity calculations and candidate generation

## Requirements

- Python 3.7+
- PyTorch
- Flask
- OpenAI API access (for ChatGPT model)
- scikit-learn
- NumPy
- Matplotlib

## Installation

1. Clone the repository:
```bash
git clone https://github.com/akrvs/coderec.git
cd coderec
```

2. Install required packages:
```bash
pip install -r requirements.txt
```

3. Set up your OpenAI API key:
```bash
export OPENAI_API_KEY='your-api-key'
```

4. Configure the application by updating the `flask_app/config.json` file with your paths.

## Usage

### Web Interface

1. Start the Flask web server:
```bash
python -m flask_app.app
```

2. Open a web browser and navigate to `http://localhost:5000`

3. Enter a prompt and select which model (LSTM or ChatGPT) to use

4. View the diverse recommendations generated by the system

### Command Line

You can also use the system via a Python script:

```python
import openai
from utils import generate_candidates_chatgpt
from utils.average_cosine_similarity import calculate_average_cosine_similarity
from flask_app.run_experiments import run_experiment
from utils.similarities import lukasiewicz_implication_2

# Set your OpenAI API key
openai.api_key = 'your-api-key'

# Run experiment with ChatGPT
prompt = "Write a function to calculate Fibonacci numbers"
results, selected_indices, selected_embeddings, MLP_output = run_experiment(
    prompt=prompt, 
    model_architecture='ChatGPT',
    num_epochs=100, 
    batch_size=128,
    learning_rate=0.01, 
    num_genes=100, 
    loss_function=lukasiewicz_implication_2
)

print(results)
```

## Key Components

### Models

1. **LSTM Model**: A custom LSTM-based language model trained on a given text corpus
2. **ChatGPT Model**: Uses OpenAI's GPT model to generate text completions
3. **MLP Model**: Processes embeddings to enhance diversity

### Genetic Algorithm

The genetic algorithm selects a subset of candidates to maximize diversity:

1. Initializes a population of candidate subsets
2. Calculates fitness based on negative average cosine similarity (higher diversity = better fitness)
3. Performs selection, crossover, and mutation to evolve the population
4. Returns the most diverse subset found

### Similarity Metrics

The system uses several similarity metrics including:
- Cosine similarity between embeddings
- Lukasiewicz implication for optimizing diversity

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

[MIT License](LICENSE)
